<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Regular expressions • stringr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Regular expressions">
<meta name="robots" content="noindex">
<script defer data-domain="stringr.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stringr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.5.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/stringr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/from-base.html">From base R</a></li>
    <li><a class="dropdown-item" href="../articles/regular-expressions.html">Regular expressions</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2022/12/stringr-1-5-0/">Version 1.5.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/02/stringr-1-4-0/">Version 1.4.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/02/stringr-1-3-0/">Version 1.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://blog.rstudio.com/2017/04/12/tidyverse-updates/">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://blog.rstudio.com/2016/08/24/stringr-1-1-0/">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://blog.rstudio.com/2015/05/05/stringr-1-0-0/">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidyverse/stringr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Regular expressions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/stringr/blob/main/vignettes/regular-expressions.Rmd" class="external-link"><code>vignettes/regular-expressions.Rmd</code></a></small>
      <div class="d-none name"><code>regular-expressions.Rmd</code></div>
    </div>

    
    
<p>Regular expressions are a concise and flexible tool for describing
patterns in strings. This vignette describes the key features of
stringr’s regular expressions, as implemented by <a href="https://github.com/gagolews/stringi" class="external-link">stringi</a>. It is not a
tutorial, so if you’re unfamiliar regular expressions, I’d recommend
starting at <a href="https://r4ds.had.co.nz/strings.html" class="external-link uri">https://r4ds.had.co.nz/strings.html</a>. If you want to
master the details, I’d recommend reading the classic <a href="https://www.amazon.com/Mastering-Regular-Expressions-Jeffrey-Friedl/dp/0596528124" class="external-link"><em>Mastering
Regular Expressions</em></a> by Jeffrey E. F. Friedl.</p>
<p>Regular expressions are the default pattern engine in stringr. That
means when you use a pattern matching function with a bare string, it’s
equivalent to wrapping it in a call to <code><a href="../reference/modifiers.html">regex()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The regular call:</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">fruit</span>, <span class="st">"nana"</span><span class="op">)</span></span>
<span><span class="co"># Is shorthand for</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">fruit</span>, <span class="fu"><a href="../reference/modifiers.html">regex</a></span><span class="op">(</span><span class="st">"nana"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>You will need to use <code><a href="../reference/modifiers.html">regex()</a></code> explicitly if you want to
override the default options, as you’ll see in examples below.</p>
<div class="section level2">
<h2 id="basic-matches">Basic matches<a class="anchor" aria-label="anchor" href="#basic-matches"></a>
</h2>
<p>The simplest patterns match exact strings:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"pear"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"an"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA   "an" NA</span></span></code></pre></div>
<p>You can perform a case-insensitive match using
<code>ignore_case = TRUE</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bananas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"banana"</span>, <span class="st">"Banana"</span>, <span class="st">"BANANA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">bananas</span>, <span class="st">"banana"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE FALSE FALSE</span></span>
<span><span class="fu"><a href="../reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">bananas</span>, <span class="fu"><a href="../reference/modifiers.html">regex</a></span><span class="op">(</span><span class="st">"banana"</span>, ignore_case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE TRUE</span></span></code></pre></div>
<p>The next step up in complexity is <code>.</code>, which matches any
character except a newline:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">".a."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA    "ban" "ear"</span></span></code></pre></div>
<p>You can allow <code>.</code> to match everything, including
<code>\n</code>, by setting <code>dotall = TRUE</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="st">"\nX\n"</span>, <span class="st">".X."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="st">"\nX\n"</span>, <span class="fu"><a href="../reference/modifiers.html">regex</a></span><span class="op">(</span><span class="st">".X."</span>, dotall <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="escaping">Escaping<a class="anchor" aria-label="anchor" href="#escaping"></a>
</h2>
<p>If “<code>.</code>” matches any character, how do you match a literal
“<code>.</code>”? You need to use an “escape” to tell the regular
expression you want to match it exactly, not use its special behaviour.
Like strings, regexps use the backslash, <code>\</code>, to escape
special behaviour. So to match an <code>.</code>, you need the regexp
<code>\.</code>. Unfortunately this creates a problem. We use strings to
represent regular expressions, and <code>\</code> is also used as an
escape symbol in strings. So to create the regular expression
<code>\.</code> we need the string <code>"\\."</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To create the regular expression, we need \\</span></span>
<span><span class="va">dot</span> <span class="op">&lt;-</span> <span class="st">"\\."</span></span>
<span></span>
<span><span class="co"># But the expression itself only contains one:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">dot</span><span class="op">)</span></span>
<span><span class="co">#&gt; \.</span></span>
<span></span>
<span><span class="co"># And this tells R to look for an explicit .</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"abc"</span>, <span class="st">"a.c"</span>, <span class="st">"bef"</span><span class="op">)</span>, <span class="st">"a\\.c"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA    "a.c" NA</span></span></code></pre></div>
<p>If <code>\</code> is used as an escape character in regular
expressions, how do you match a literal <code>\</code>? Well you need to
escape it, creating the regular expression <code>\\</code>. To create
that regular expression, you need to use a string, which also needs to
escape <code>\</code>. That means to match a literal <code>\</code> you
need to write <code>"\\\\"</code> — you need four backslashes to match
one!</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">"a\\b"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; a\b</span></span>
<span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"\\\\"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "\\"</span></span></code></pre></div>
<p>In this vignette, I use <code>\.</code> to denote the regular
expression, and <code>"\\."</code> to denote the string that represents
the regular expression.</p>
<p>An alternative quoting mechanism is <code>\Q...\E</code>: all the
characters in <code>...</code> are treated as exact matches. This is
useful if you want to exactly match user input as part of a regular
expression.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a.b.c.d"</span>, <span class="st">"aeb"</span><span class="op">)</span></span>
<span><span class="va">starts_with</span> <span class="op">&lt;-</span> <span class="st">"a.b"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"^"</span>, <span class="va">starts_with</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE</span></span>
<span><span class="fu"><a href="../reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"^\\Q"</span>, <span class="va">starts_with</span>, <span class="st">"\\E"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE FALSE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="special-characters">Special characters<a class="anchor" aria-label="anchor" href="#special-characters"></a>
</h2>
<p>Escapes also allow you to specify individual characters that are
otherwise hard to type. You can specify individual unicode characters in
five ways, either as a variable number of hex digits (four is most
common), or by name:</p>
<ul>
<li><p><code>\xhh</code>: 2 hex digits.</p></li>
<li><p><code>\x{hhhh}</code>: 1-6 hex digits.</p></li>
<li><p><code>\uhhhh</code>: 4 hex digits.</p></li>
<li><p><code>\Uhhhhhhhh</code>: 8 hex digits.</p></li>
<li><p><code>\N{name}</code>, e.g. <code>\N{grinning face}</code>
matches the basic smiling emoji.</p></li>
</ul>
<p>Similarly, you can specify many common control characters:</p>
<ul>
<li><p><code>\a</code>: bell.</p></li>
<li><p><code>\cX</code>: match a control-X character.</p></li>
<li><p><code>\e</code>: escape (<code>\u001B</code>).</p></li>
<li><p><code>\f</code>: form feed (<code>\u000C</code>).</p></li>
<li><p><code>\n</code>: line feed (<code>\u000A</code>).</p></li>
<li><p><code>\r</code>: carriage return (<code>\u000D</code>).</p></li>
<li><p><code>\t</code>: horizontal tabulation
(<code>\u0009</code>).</p></li>
<li><p><code>\0ooo</code> match an octal character. ‘ooo’ is from one to
three octal digits, from 000 to 0377. The leading zero is
required.</p></li>
</ul>
<p>(Many of these are only of historical interest and are only included
here for the sake of completeness.)</p>
</div>
<div class="section level2">
<h2 id="matching-multiple-characters">Matching multiple characters<a class="anchor" aria-label="anchor" href="#matching-multiple-characters"></a>
</h2>
<p>There are a number of patterns that match more than one character.
You’ve already seen <code>.</code>, which matches any character (except
a newline). A closely related operator is <code>\X</code>, which matches
a <strong>grapheme cluster</strong>, a set of individual elements that
form a single symbol. For example, one way of representing “á” is as the
letter “a” plus an accent: <code>.</code> will match the component “a”,
while <code>\X</code> will match the complete symbol:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">"a\u0301"</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "a"</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"\\X"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "á"</span></span></code></pre></div>
<p>There are five other escaped pairs that match narrower classes of
characters:</p>
<ul>
<li>
<p><code>\d</code>: matches any digit. The complement,
<code>\D</code>, matches any character that is not a decimal digit.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/str_extract.html">str_extract_all</a></span><span class="op">(</span><span class="st">"1 + 2 = 3"</span>, <span class="st">"\\d+"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "1" "2" "3"</span></span></code></pre></div>
<p>Technically, <code>\d</code> includes any character in the Unicode
Category of Nd (“Number, Decimal Digit”), which also includes numeric
symbols from other languages:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Some Laotian numbers</span></span>
<span><span class="fu"><a href="../reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="st">"១២៣"</span>, <span class="st">"\\d"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</li>
<li>
<p><code>\s</code>: matches any whitespace. This includes tabs,
newlines, form feeds, and any character in the Unicode Z Category (which
includes a variety of space characters and other separators.). The
complement, <code>\S</code>, matches any non-whitespace character.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">text</span> <span class="op">&lt;-</span> <span class="st">"Some  \t badly\n\t\tspaced \f text"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Some  \t badly\n\t\tspaced \f text"</span></span>
<span><span class="fu"><a href="../reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">text</span>, <span class="st">"\\s+"</span>, <span class="st">" "</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Some badly spaced text"</span></span></code></pre></div>
</li>
<li>
<p><code>\p{property name}</code> matches any character with
specific unicode property, like <code>\p{Uppercase}</code> or
<code>\p{Diacritic}</code>. The complement,
<code>\P{property name}</code>, matches all characters without the
property. A complete list of unicode properties can be found at <a href="http://www.unicode.org/reports/tr44/#Property_Index" class="external-link uri">http://www.unicode.org/reports/tr44/#Property_Index</a>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'"Double quotes"'</span>, <span class="st">"«Guillemet»"</span>, <span class="st">"“Fancy quotes”"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "\"Double quotes\"" "«Guillemet»"       "“Fancy quotes”"</span></span>
<span><span class="fu"><a href="../reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">text</span>, <span class="st">"\\p{quotation mark}"</span>, <span class="st">"'"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "'Double quotes'" "'Guillemet'"     "'Fancy quotes'"</span></span></code></pre></div>
</li>
<li>
<p><code>\w</code> matches any “word” character, which includes
alphabetic characters, marks and decimal numbers. The complement,
<code>\W</code>, matches any non-word character.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/str_extract.html">str_extract_all</a></span><span class="op">(</span><span class="st">"Don't eat that!"</span>, <span class="st">"\\w+"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "Don"  "t"    "eat"  "that"</span></span>
<span><span class="fu"><a href="../reference/str_split.html">str_split</a></span><span class="op">(</span><span class="st">"Don't eat that!"</span>, <span class="st">"\\W"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "Don"  "t"    "eat"  "that" ""</span></span></code></pre></div>
<p>Technically, <code>\w</code> also matches connector punctuation,
<code>\u200c</code> (zero width connector), and <code>\u200d</code>
(zero width joiner), but these are rarely seen in the wild.</p>
</li>
<li>
<p><code>\b</code> matches word boundaries, the transition between
word and non-word characters. <code>\B</code> matches the opposite:
boundaries that have either both word or non-word characters on either
side.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">"The quick brown fox"</span>, <span class="st">"\\b"</span>, <span class="st">"_"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "_The_ _quick_ _brown_ _fox_"</span></span>
<span><span class="fu"><a href="../reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">"The quick brown fox"</span>, <span class="st">"\\B"</span>, <span class="st">"_"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "T_h_e q_u_i_c_k b_r_o_w_n f_o_x"</span></span></code></pre></div>
</li>
</ul>
<p>You can also create your own <strong>character classes</strong> using
<code>[]</code>:</p>
<ul>
<li>
<code>[abc]</code>: matches a, b, or c.</li>
<li>
<code>[a-z]</code>: matches every character between a and z (in
Unicode code point order).</li>
<li>
<code>[^abc]</code>: matches anything except a, b, or c.</li>
<li>
<code>[\^\-]</code>: matches <code>^</code> or <code>-</code>.</li>
</ul>
<p>There are a number of pre-built classes that you can use inside
<code>[]</code>:</p>
<ul>
<li>
<code>[:punct:]</code>: punctuation.</li>
<li>
<code>[:alpha:]</code>: letters.</li>
<li>
<code>[:lower:]</code>: lowercase letters.</li>
<li>
<code>[:upper:]</code>: upperclass letters.</li>
<li>
<code>[:digit:]</code>: digits.</li>
<li>
<code>[:xdigit:]</code>: hex digits.</li>
<li>
<code>[:alnum:]</code>: letters and numbers.</li>
<li>
<code>[:cntrl:]</code>: control characters.</li>
<li>
<code>[:graph:]</code>: letters, numbers, and punctuation.</li>
<li>
<code>[:print:]</code>: letters, numbers, punctuation, and
whitespace.</li>
<li>
<code>[:space:]</code>: space characters (basically equivalent to
<code>\s</code>).</li>
<li>
<code>[:blank:]</code>: space and tab.</li>
</ul>
<p>These all go inside the <code>[]</code> for character classes,
i.e. <code>[[:digit:]AX]</code> matches all digits, A, and X.</p>
<p>You can also using Unicode properties, like
<code>[\p{Letter}]</code>, and various set operations, like
<code>[\p{Letter}--\p{script=latin}]</code>. See
<code>?"stringi-search-charclass"</code> for details.</p>
</div>
<div class="section level2">
<h2 id="alternation">Alternation<a class="anchor" aria-label="anchor" href="#alternation"></a>
</h2>
<p><code>|</code> is the <strong>alternation</strong> operator, which
will pick between one or more possible matches. For example,
<code>abc|def</code> will match <code>abc</code> or
<code>def</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"abc"</span>, <span class="st">"def"</span>, <span class="st">"ghi"</span><span class="op">)</span>, <span class="st">"abc|def"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE  TRUE FALSE</span></span></code></pre></div>
<p>Note that the precedence for <code>|</code> is low:
<code>abc|def</code> is equivalent to <code>(abc)|(def)</code> not
<code>ab(c|d)ef</code>.</p>
</div>
<div class="section level2">
<h2 id="grouping">Grouping<a class="anchor" aria-label="anchor" href="#grouping"></a>
</h2>
<p>You can use parentheses to override the default precedence rules:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey"</span>, <span class="st">"gray"</span><span class="op">)</span>, <span class="st">"gre|ay"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "gre" "ay"</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey"</span>, <span class="st">"gray"</span><span class="op">)</span>, <span class="st">"gr(e|a)y"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "grey" "gray"</span></span></code></pre></div>
<p>Parenthesis also define “groups” that you can refer to with
<strong>backreferences</strong>, like <code>\1</code>, <code>\2</code>
etc, and can be extracted with <code><a href="../reference/str_match.html">str_match()</a></code>. For example,
the following regular expression finds all fruits that have a repeated
pair of letters:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pattern</span> <span class="op">&lt;-</span> <span class="st">"(..)\\1"</span></span>
<span><span class="va">fruit</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/str_subset.html">str_subset</a></span><span class="op">(</span><span class="va">pattern</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "banana"      "coconut"     "cucumber"    "jujube"     </span></span>
<span><span class="co">#&gt; [5] "papaya"      "salal berry"</span></span>
<span></span>
<span><span class="va">fruit</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/str_subset.html">str_subset</a></span><span class="op">(</span><span class="va">pattern</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/str_match.html">str_match</a></span><span class="op">(</span><span class="va">pattern</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]   [,2]</span></span>
<span><span class="co">#&gt; [1,] "anan" "an"</span></span>
<span><span class="co">#&gt; [2,] "coco" "co"</span></span>
<span><span class="co">#&gt; [3,] "cucu" "cu"</span></span>
<span><span class="co">#&gt; [4,] "juju" "ju"</span></span>
<span><span class="co">#&gt; [5,] "papa" "pa"</span></span>
<span><span class="co">#&gt; [6,] "alal" "al"</span></span></code></pre></div>
<p>You can use <code>(?:...)</code>, the non-grouping parentheses, to
control precedence but not capture the match in a group. This is
slightly more efficient than capturing parentheses.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/str_match.html">str_match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey"</span>, <span class="st">"gray"</span><span class="op">)</span>, <span class="st">"gr(e|a)y"</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]   [,2]</span></span>
<span><span class="co">#&gt; [1,] "grey" "e" </span></span>
<span><span class="co">#&gt; [2,] "gray" "a"</span></span>
<span><span class="fu"><a href="../reference/str_match.html">str_match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey"</span>, <span class="st">"gray"</span><span class="op">)</span>, <span class="st">"gr(?:e|a)y"</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]  </span></span>
<span><span class="co">#&gt; [1,] "grey"</span></span>
<span><span class="co">#&gt; [2,] "gray"</span></span></code></pre></div>
<p>This is most useful for more complex cases where you need to capture
matches and control precedence independently.</p>
</div>
<div class="section level2">
<h2 id="anchors">Anchors<a class="anchor" aria-label="anchor" href="#anchors"></a>
</h2>
<p>By default, regular expressions will match any part of a string. It’s
often useful to <strong>anchor</strong> the regular expression so that
it matches from the start or end of the string:</p>
<ul>
<li>
<code>^</code> matches the start of string.</li>
<li>
<code>$</code> matches the end of the string.</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"pear"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"^a"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "a" NA  NA</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"a$"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA  "a" NA</span></span></code></pre></div>
<p>To match a literal “$” or “^”, you need to escape them,
<code>\$</code>, and <code>\^</code>.</p>
<p>For multiline strings, you can use
<code>regex(multiline = TRUE)</code>. This changes the behaviour of
<code>^</code> and <code>$</code>, and introduces three new
operators:</p>
<ul>
<li><p><code>^</code> now matches the start of each line.</p></li>
<li><p><code>$</code> now matches the end of each line.</p></li>
<li><p><code>\A</code> matches the start of the input.</p></li>
<li><p><code>\z</code> matches the end of the input.</p></li>
<li><p><code>\Z</code> matches the end of the input, but before the
final line terminator, if it exists.</p></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">"Line 1\nLine 2\nLine 3\n"</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract_all</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"^Line.."</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "Line 1"</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract_all</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="../reference/modifiers.html">regex</a></span><span class="op">(</span><span class="st">"^Line.."</span>, multiline <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "Line 1" "Line 2" "Line 3"</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract_all</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="../reference/modifiers.html">regex</a></span><span class="op">(</span><span class="st">"\\ALine.."</span>, multiline <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "Line 1"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="repetition">Repetition<a class="anchor" aria-label="anchor" href="#repetition"></a>
</h2>
<p>You can control how many times a pattern matches with the repetition
operators:</p>
<ul>
<li>
<code>?</code>: 0 or 1.</li>
<li>
<code>+</code>: 1 or more.</li>
<li>
<code>*</code>: 0 or more.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">"1888 is the longest year in Roman numerals: MDCCCLXXXVIII"</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"CC?"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CC"</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"CC+"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CCC"</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'C[LX]+'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CLXXX"</span></span></code></pre></div>
<p>Note that the precedence of these operators is high, so you can
write: <code>colou?r</code> to match either American or British
spellings. That means most uses will need parentheses, like
<code>bana(na)+</code>.</p>
<p>You can also specify the number of matches precisely:</p>
<ul>
<li>
<code>{n}</code>: exactly n</li>
<li>
<code>{n,}</code>: n or more</li>
<li>
<code>{n,m}</code>: between n and m</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"C{2}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CC"</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"C{2,}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CCC"</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"C{2,3}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CCC"</span></span></code></pre></div>
<p>By default these matches are “greedy”: they will match the longest
string possible. You can make them “lazy”, matching the shortest string
possible by putting a <code>?</code> after them:</p>
<ul>
<li>
<code>??</code>: 0 or 1, prefer 0.</li>
<li>
<code>+?</code>: 1 or more, match as few times as possible.</li>
<li>
<code>*?</code>: 0 or more, match as few times as possible.</li>
<li>
<code>{n,}?</code>: n or more, match as few times as possible.</li>
<li>
<code>{n,m}?</code>: between n and m, , match as few times as
possible, but at least n.</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C{2,3}"</span>, <span class="st">"C{2,3}?"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CCC" "CC"</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C[LX]+"</span>, <span class="st">"C[LX]+?"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CLXXX" "CL"</span></span></code></pre></div>
<p>You can also make the matches possessive by putting a <code>+</code>
after them, which means that if later parts of the match fail, the
repetition will not be re-tried with a smaller number of characters.
This is an advanced feature used to improve performance in worst-case
scenarios (called “catastrophic backtracking”).</p>
<ul>
<li>
<code>?+</code>: 0 or 1, possessive.</li>
<li>
<code>++</code>: 1 or more, possessive.</li>
<li>
<code>*+</code>: 0 or more, possessive.</li>
<li>
<code>{n}+</code>: exactly n, possessive.</li>
<li>
<code>{n,}+</code>: n or more, possessive.</li>
<li>
<code>{n,m}+</code>: between n and m, possessive.</li>
</ul>
<p>A related concept is the <strong>atomic-match</strong> parenthesis,
<code>(?&gt;...)</code>. If a later match fails and the engine needs to
back-track, an atomic match is kept as is: it succeeds or fails as a
whole. Compare the following two regular expressions:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="st">"ABC"</span>, <span class="st">"(?&gt;A|.B)C"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="st">"ABC"</span>, <span class="st">"(?:A|.B)C"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>The atomic match fails because it matches A, and then the next
character is a C so it fails. The regular match succeeds because it
matches A, but then C doesn’t match, so it back-tracks and tries B
instead.</p>
</div>
<div class="section level2">
<h2 id="look-arounds">Look arounds<a class="anchor" aria-label="anchor" href="#look-arounds"></a>
</h2>
<p>These assertions look ahead or behind the current match without
“consuming” any characters (i.e. changing the input position).</p>
<ul>
<li><p><code>(?=...)</code>: positive look-ahead assertion. Matches if
<code>...</code> matches at the current input.</p></li>
<li><p><code>(?!...)</code>: negative look-ahead assertion. Matches if
<code>...</code> <strong>does not</strong> match at the current
input.</p></li>
<li><p><code>(?&lt;=...)</code>: positive look-behind assertion. Matches
if <code>...</code> matches text preceding the current position, with
the last character of the match being the character just before the
current position. Length must be bounded<br>
(i.e. no <code>*</code> or <code>+</code>).</p></li>
<li><p><code>(?&lt;!...)</code>: negative look-behind assertion. Matches
if <code>...</code> <strong>does not</strong> match text preceding the
current position. Length must be bounded<br>
(i.e. no <code>*</code> or <code>+</code>).</p></li>
</ul>
<p>These are useful when you want to check that a pattern exists, but
you don’t want to include it in the result:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1 piece"</span>, <span class="st">"2 pieces"</span>, <span class="st">"3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"\\d+(?= pieces?)"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "1" "2" NA</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"100"</span>, <span class="st">"$400"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">y</span>, <span class="st">"(?&lt;=\\$)\\d+"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA    "400"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comments">Comments<a class="anchor" aria-label="anchor" href="#comments"></a>
</h2>
<p>There are two ways to include comments in a regular expression. The
first is with <code>(?#...)</code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="st">"xyz"</span>, <span class="st">"x(?#this is a comment)"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>The second is to use <code>regex(comments = TRUE)</code>. This form
ignores spaces and newlines, and anything everything after
<code>#</code>. To match a literal space, you’ll need to escape it:
<code>"\\ "</code>. This is a useful way of describing complex regular
expressions:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phone</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifiers.html">regex</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  \\(?       # optional opening parens</span></span>
<span><span class="st">  (\\d{3})   # area code</span></span>
<span><span class="st">  \\)?       # optional closing parens</span></span>
<span><span class="st">  (?:-|\\ )? # optional dash or space</span></span>
<span><span class="st">  (\\d{3})   # another three numbers</span></span>
<span><span class="st">  (?:-|\\ )? # optional dash or space</span></span>
<span><span class="st">  (\\d{3})   # three more numbers</span></span>
<span><span class="st">  "</span>, comments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/str_match.html">str_match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"514-791-8141"</span>, <span class="st">"(514) 791 8141"</span><span class="op">)</span>, <span class="va">phone</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]            [,2]  [,3]  [,4] </span></span>
<span><span class="co">#&gt; [1,] "514-791-814"   "514" "791" "814"</span></span>
<span><span class="co">#&gt; [2,] "(514) 791 814" "514" "791" "814"</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer>
</body>
</html>
